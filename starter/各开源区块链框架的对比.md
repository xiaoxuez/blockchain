## 各开源区块链框架的对比

主要列举一些开源区块链框架的对比。主要包括比特币，以太坊，Fabric，Onchain DNA， Corda。

Fabric特别的点在于它从一开始就是一个框架，没有内置代币。但可以通过 Chaincode 实现本币发行和账户功能。作为一个区块链框架，Fabric采用了松耦合的设计，将共识机制、身份验证等组件模块化，使之在应用过程中可以方便地根据应用场景来选择相应的模块。除此之外，Fabric还采用了容器技术，将智能合约代码（Chaincode）放在Docker中运行，从而使智能合约可以用几乎任意的高级语言来编写。但Docker也面对着架构方面的缺陷。

Onchain DNA（Onchain Distributed Networks Architecture），是由总部位于上海的区块链创业公司“分布科技”开发的区块链架构，可以同时支持公有链、联盟链、私有链等不同应用类型和场景，并快速与业务系统集成。特别的地方在于在系统底层实现了对多种数字资产的支持，用户可以直接在链上创建自己的资产类型，并用智能合约来控制它的发行和交易逻辑。

Corda是一款专门用于银行与银行间业务的技术架构



#### 链种：公有链/私有链/联盟链

|             | 公有链/私有链/联盟链 |
| :---------: | :------------------: |
|   比特币    |        公有链        |
|   以太坊    |        公有链        |
|   Fabric    |        联盟链        |
| Onchain DNA |        自定义        |
|    Corda    |        私有链        |

公有链、私有链、联盟链的解释如下： 区块链技术现阶段主要划分为公有链、私有链、联盟链，即公共区块链，私有区块链，联盟区块链。简单来说，公有链：对所有人开放，任何人都可以参与；联盟链：对特定的组织团体开放；私有链：对单独的个人或实体开放，严格上来说联盟链是可划分到私有链之列的。**公有链**是指全世界任何人都可读取的、任何人都能发送交易且交易能获得有效确认的、任何人都能参与其中共识过程的区块链——共识过程决定哪个区块可被添加到区块链中和明确当前状态。**私有链**是指其写入权限仅在一个组织手里的区块链。读取权限或者对外开放，或者被任意程度地进行了限制。其中特点此处省略，[详情可见](http://tech.sina.com.cn/i/2016-08-09/doc-ifxutfpf1573966.shtml)



####  数字资产

|             | 内置代币 |     多种数字资产     |
| :---------: | :------: | :------------------: |
|   比特币    |    有    | 通过外部协议层来支持 |
|   以太坊    |    有    |   通过智能合约实现   |
|   Fabric    |    无    |   通过智能合约实现   |
| Onchain DNA |   可选   |       底层支持       |
|    Corda    |    无    |       底层支持       |



#### 账户系统

|             | 账户设计  | 身份认证 |
| :---------: | :-------: | :------: |
|   比特币    |   UTXO    |    无    |
|   以太坊    |   余额    |    无    |
|   Fabric    |     -     | 数字证书 |
| Onchain DNA | UTXO+余额 | 数字证书 |
|    Corda    |   UTXO    | 数字证书 |

UTXO与余额：，UTXO为未花费的交易输出，简单点来说就是一系列散钱，计算余额的时候需要将所有的面额相加，余额直接就是余额了，二者的区别呢，基于UTXO的交易可以并行验证且任意排序，因为所有的UTXO之间都是没有关联的，这对区块链未来的扩展性有很大的帮助，而基于余额的设计就没有这个优势了。反过来，余额设计的优点是设计思想非常简洁和直观，便于程序实现，特别是在智能合约中，要处理UTXO的状态是非常困难的。

Fabric中没有代币概念, 但可以通过 Chaincode 实现本币发行和账户功能

没有身份认证更强调隐私和匿名，反对监管和中心化，而身份认证就势必要引入一些中心或者弱化的中心机构。



#### 共识机制

|             |  模型   | 出块时间  |
| :---------: | :-----: | :-------: |
|   比特币    |   POW   | 平均10min |
|   以太坊    | POW+POS |  平均12s  |
|   Fabric    |   BFT   |  自定义   |
| Onchain DNA |   BFT   |  自定义   |
|    Corda    | 不适用  |  不适用   |

工作量证明机制(PoW)能提供较高的灵活性和可用性，相对的，BFT就牺牲了一定的灵活性和可用性。Corda 可以对每一笔交易实时达成共识。但由于没有统一总账, 每个“节点”必须自行存储自己的交易数据,自行解决自身的网络级、系统级、应用级、数据级的容灾备份问题



#### 智能合约

|             | 图灵完备 |   执行环境   | 持久化 |
| :---------: | :------: | :----------: | :----: |
|   比特币    |    否    | 内置脚本引擎 |   无   |
|   以太坊    |    是    |     EVM      |   有   |
|   Fabric    |    是    |    Docker    |   有   |
| Onchain DNA |    是    |     AVM      |   有   |
|    Corda    |    是    |     JVM      |   无   |

Corda使用Kotlin作为开发语言，合约可以使用Java、Kotlin或者其他基于JVM的语言来编写

采用Docker的智能合约的缺点，首先，它很难对智能合约的执行流程进行控制，从而无法对其功能进行限制；其次，它无法对合约运行所消耗的计算资源进行精确的评估；此外，运行Docker相对而言是极其耗费资源的操作，这就使得难以在移动设备上运行合约；最后，不同节点的硬件配置、合约引用的开发库等，都有可能会使合约的行为具有很强的不确定性。



#### 扩展性

|             | 空间回收 | 并行验证 |
| :---------: | :------: | :------: |
|   比特币    | 区块压缩 |   支持   |
|   以太坊    | 状态快照 |   分区   |
|   Fabric    | 状态快照 |  不支持  |
| Onchain DNA | 状态快照 |   分区   |
|    Corda    |  不适用  |   支持   |

区块链的数据结构通常是只能追加记录，而不能修改或删除记录，它真实地记录下完整的历史数据，使得新加入的节点有能力对全网的完整交易历史进行验证，而无需信任其它节点。这种特性带来了去中心化的便利性，但也影响了区块链系统的扩展性，因为区块会无休止地增长，直到塞满整个硬盘。所以有必要提供一种空间回收的机制来应对不断增长的数据。



#### 通信技术

|        |                           通信技术                           |
| :----: | :----------------------------------------------------------: |
| 以太坊 | 客户端 P2P协议是一个标准的加密货币协议 , 能够容易地为其它加密货币使用 |
| Fabric |       运用 Google RPC 协议, 能与现有的网络基础设施结合       |
| Corda  | 通讯协议基于 AMQP/1.0, 采用 TLS 作为加密协议, 并内嵌了一个支持 AMQP/1.0 的全功能的消息中间件, 适合于嵌入式应用 |



#### 平台实用性方面

+ 大量的数字货币项目都是基于比特币架构来设计的，案例如彩色币等


+ 以太坊不仅适用于公链场景, 也可以部署联盟链或私有链。 Ethereum 可利用图灵完备的智能合约, 适应金融应用、物联网、供应链管理、社交网络、去中心化自治组织(DAO)、预测市场等场景；基于以太坊的合约项目已达到数百个，比较有名的有Augur、TheDAO、FirstBlood等
+ Fabric 可广泛应用于跨行业应用场景中,可满足金融服 务、供应链管理、智能制造、文化娱乐、医疗健康、社会公 益、教育就业等领域的应用。Fabric相对来说比较年轻，基于Fabric架构的项目也刚刚起步，还没有比较成熟的落地应用
+ Corda 聚焦于分布式账本技术在金融领域的应用, 定位为面向非公有链的场景
+ 目前已有不少金融机构采用Onchain DNA架构来进行区块链概念验证产品的开发，如银行、券商、支付、登记结算机构等。案例如小蚁、法链等






#### 个人小结

 以上资料基本都是从网上找的，个人理解的话，觉之尚浅。这些天，看了比特币的架构和基本实现，以太坊的架构，fabric的架构。要说理解的话，总觉得不每个试一下，每个坑都跳一次，自己很难有特别的理解。虽然目前认识仍是浅薄，也大概说一下，也算有点产出吧...从技术出发总结一下区块链的整体结构。

既然浅薄，必然是从最初的出发，区块链的本质，分布式数据库系统。

首先，分布式结构而言，必然存在节点诚信、同步类似问题，在区块链的概念里，解决这类问题的概念称为**共识**。各大框架共识的方式有所不同，不同的共识机制也带来不同的优劣，例如POW相当可靠，但浪费资源，需要庞大算力，POS的话就不浪费资源，但可靠性就略弱一些。基于BFT的共识机制相较POW和POS的话，优点在于最大限度地确保系统的最终性，缺点在于牺牲了一定的灵活性和可用性，如果出现1/3的记账节点停机，那么网络就会变得不可用。共识机制的选择，在交易吞吐量和交易确认时间也是有很大影响。

其次，**智能合约**的实现和完备，成为了区块链框架中又一重点。比特币的智能合约实现为仅针对货币转账的需求。以太坊的合约编写需要特定语言，合约运行在特定虚拟机上，合约运行过程中对于代码运行所需要的算力需要支付相应的代价，很大程度能避免利用合约进行的资源浪费攻击。Fabric采用Docker来支持智能合约，对于智能合约的开发者就相当友好，可以使用任何语言来编写，但相对的，对计算资源就不能进行精确的评估，另外，选择docker本身也就会带来一定的问题。

最后，就是整个架构中的一些优化选择了，例如账户设计，存储的数据结构等，或者是否需要实现SPV模式。




**参考**

1. [比特币、以太坊、Fabric…你知道它们的优缺点吗?](https://blog.csdn.net/blockchain_lemon/article/details/79236199)
2. [以太坊、Fabric、Corda对比](https://medium.com/@makersu/ethereum-vs-hyperledger-fabric-vs-corda-bef3b54836fa)

