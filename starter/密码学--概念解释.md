## 区块链中使用到的密码学

#### 哈希算法

将任意长度的消息压缩为固定长度的二进制串，其输出称为哈希值，也称为散列值。

哈希函数的性质包括

+ 抗碰撞性，所谓碰撞是指两个不同的消息在同一个哈希函数作用下，具有相同的哈希值，哈希函数的扛碰撞性是指寻找两个能够产生碰撞的消息在计算上是不可行的。
+ 原像不可逆，指的是知道输入值，很容易通过哈希计算出哈希值，但知道哈希值，没有办法计算出原来的输入值。
+ 难题友好性，没有便捷的方法去产生一满足特殊要求的哈希值。

哈希函数的应用，在区块链中，可用于验证消息的完整性。

#### 加密

+ 对称加密，加密解密钥匙为同一把
+ 非对称加密，钥匙分为私钥和公钥，私钥加密，公钥解密

区块链中所使用的公钥密码算法是椭圆曲线算法。椭圆曲线函数的特性为曲线上的两个不同的点相加所得到的点仍在原曲线上，即P + P + P + P .. = k*P = Q，其中P、Q为均曲线上的点。且有特性如下，已知k和点P，求Q容易，但已知点P,Q，求k超超难，运用在实际中，k对应为私钥，Q对应为公钥。

#### 数字签名

数字签名可保证消息的真实性和不可否认性。数字签名为使用私钥对消息摘要进行签名生成数字签名，验证数字签名时使用消息摘要，公钥、数字签名带入算法即可验证。

其中，签名算法，例如ECDSA，又或者BLS.. (<u>emm，虽然有说签名就是公钥密码“反过来”实现的.但签名的算法其实没看懂</u>.)， 然后BLS的优势是签名长度短，在当前应用中，使用BLS签名的主要是与VRF一起使用，如DFINITY项目~

#### 数字证书

一般使用上是对方持有你的公钥，你用私钥加密，发送给对方，对方使用你的公钥进行解密，问题在于万一对方持有的你的公钥被替换了，对方无法确认公钥是否是属于你的，解决方式呢，就是存在一个证书中心，所有人都持有证书中心的公钥，证书中心使用自己的私钥，对你的公钥和一些相关信息进行一起加密，生成数字证书，你在发送信息的时候附带上数字证书一起发送。

数字证书使用的示例之一为，https协议，网页加密。

首先，客户端向服务器发出加密请求，服务器用自己的私钥加密网页以后，连同本身的数字证书，一起发送给客户端，客户端(浏览器)的证书管理器中，有受信任的根证书颁发机构列表，客户端会根据这张列表，查看解开数字证书的公钥是否在列表之内(证书中心是否可靠)。如果数字证书记载的网址，与你正在浏览的网址不一致，就说明这张证书可能被冒用，浏览器会发出警告，如果这张证书不是由受信任的机构颁发的，浏览器会发出另一种警告，如果数字证书是可靠的，客户端就可以使用证书中的服务器公钥，对信息进行加密，然后与服务器交换加密信息。



#### 应用

消息传输安全体系。

当发送方A向B发送数据时，需要考虑的问题有

+ 数据的安全性，即数据不被偷窥
+ 数据的完整性，即数据不被篡改
+ 数据的真实性，即数据确实来自发送方，传输过程中没有被替换
+ 数据的不可否认性，即发送方不能抵赖发送了消息



上述算法对应安全体系中，关系如下

![img](https://images2015.cnblogs.com/blog/802212/201703/802212-20170307221220969-754021676.png)



##### MAC 与数字签名的对比

MAC，消息认证码。由消息和密钥生成MAC值，可用于确认完整性和真实性。

其实看起来和数字签名是有点像的，区别在于，MAC使用对称加密，加密解密的密钥是一样的，数字签名使用非对称加密，所以MAC不能保证发送方可以否认发送过数据，而数字签名却可以保证他不能抵赖(私钥只有你自己知道)。



